{
  "project": {
    "type": "brownfield",
    "existingCodebase": "D:\\RalphTemplate\\RalpFI",
    "name": "F1 Live Race Prediction",
    "tagline": "Real-time race outcome predictions during replay",
    "description": "Add predictive analytics to the F1 Race Replay app that forecasts race outcomes, pit windows, and position changes based on current race state and historical data."
  },
  "users": {
    "primary": "F1 data enthusiasts and fans",
    "personas": [
      {
        "name": "Strategy Nerd",
        "needs": "Wants to understand when drivers should pit and predict undercuts/overcuts"
      },
      {
        "name": "Casual Fan",
        "needs": "Wants simple win probability percentages like sports betting displays"
      },
      {
        "name": "Fantasy F1 Player",
        "needs": "Wants to see points predictions and position change likelihood"
      }
    ]
  },
  "features": {
    "core": [
      {
        "id": "PRED-01",
        "name": "Win Probability Display",
        "description": "Show real-time win probability percentage for each driver based on current position, gap to leader, tyre state, and historical data. Updates every few seconds during replay."
      },
      {
        "id": "PRED-02",
        "name": "Pit Window Predictor",
        "description": "Calculate and display optimal pit windows for each driver based on tyre degradation curves, track position, and gap to cars behind. Show 'pit now' recommendations."
      },
      {
        "id": "PRED-03",
        "name": "Position Change Alerts",
        "description": "Predict imminent overtakes based on pace delta, DRS availability, tyre advantage. Show 'danger zone' warnings when a driver is about to be passed."
      },
      {
        "id": "PRED-04",
        "name": "Prediction Overlay Panel",
        "description": "New UI panel that displays all predictions in a clean, toggleable overlay. Can be positioned and resized. Shows confidence levels for each prediction."
      }
    ],
    "future": [
      {
        "id": "PRED-10",
        "name": "ML Model Training",
        "description": "Train custom models on historical race data for more accurate predictions"
      },
      {
        "id": "PRED-11",
        "name": "Safety Car Probability",
        "description": "Predict likelihood of safety car based on track characteristics and race incidents"
      },
      {
        "id": "PRED-12",
        "name": "Weather Impact Predictions",
        "description": "Factor in weather changes to predictions when rain is approaching"
      }
    ]
  },
  "techStack": {
    "existing": ["Python 3.8+", "FastF1", "Arcade", "PySide6", "pandas", "numpy"],
    "add": ["scikit-learn (for predictions)", "scipy (for statistics)"]
  },
  "dataModels": {
    "PredictionState": {
      "fields": ["driver_code", "win_probability", "podium_probability", "pit_window_start", "pit_window_end", "danger_level", "predicted_finish"],
      "relationships": ["references: race_telemetry frames"]
    },
    "PaceModel": {
      "fields": ["driver_code", "current_pace", "tyre_deg_rate", "fuel_corrected_pace", "gap_trend"],
      "relationships": ["computed_from: telemetry"]
    }
  },
  "integrationPoints": {
    "existingFiles": {
      "src/interfaces/race_replay.py": "Add prediction panel to the race replay window",
      "src/ui_components.py": "Add new UI components for prediction display",
      "src/f1_data.py": "Extract additional data needed for predictions"
    },
    "newFiles": {
      "src/predictions/engine.py": "Core prediction algorithms",
      "src/predictions/models.py": "Statistical models for pace and position",
      "src/predictions/ui.py": "Prediction panel UI components"
    }
  },
  "constraints": {
    "performance": "Predictions must calculate in <100ms to not lag replay",
    "accuracy": "Win probability should correlate with actual results >70% of time",
    "uxPrinciple": "Predictions should enhance, not distract from race viewing",
    "compatibility": "Must work with existing replay controls and HUD toggle"
  }
}
